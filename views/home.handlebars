<h1>One Minute Song Blog</h1>
<h3>Log in with your SoundCloud account to get started.</h3>
<script src="//connect.soundcloud.com/sdk.js"></script>
<script>
  SC.initialize({
    client_id: "dc1c355c11bda78ef0e6ab0266cb2761",
    redirect_uri: "http://127.0.0.1:3000/callback",
  });

SC.connect(function(){
    
    //get User ID
    SC.get('/me', function(me){
  		var userId = me['id'];

  		//get tracks by user
  		SC.get('/users/' + userId + '/tracks', function(tracks){
  			
  			//put all one minute tracks in an array
  			var oneMinuteSongs = [];
  			for(var i = 0; i < tracks.length; i++) {
  				var track = tracks[i];
  				var genre = track['genre'];
  				var songTags = track['tag_list'].split('"');
  				
  				//first tags are listed as genre properties, so check there first
  				if (genre == "one minute"){
  						oneMinuteSongs.push(track);
  				} else {
  				
  				//check remainder of tags for one minute tag
  				for (var tag in songTags) {
  					if (songTags[tag] == "one minute") {
  						oneMinuteSongs.push(track);
  					}
  				}
  				};	
  			}

  			//add all one minute songs to page
  			for(song in oneMinuteSongs) {
				var track_url = oneMinuteSongs[song]['permalink_url'];
				(function(oneMinuteSongs, song){
					SC.oEmbed(track_url, function(oEmbed) {
						var div = document.createElement('div');
						div.innerHTML = oEmbed.html;
						document.body.appendChild(div);
					});
				})(oneMinuteSongs, song);
  			}

  		});
  });
});
</script>
